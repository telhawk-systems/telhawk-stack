{
  "name": "lolbins_execution",
  "description": "Detects execution of Living-off-the-Land Binaries (LOLBins) commonly abused by attackers: certutil, regsvr32, mshta, rundll32, msiexec",
  "model": {
    "correlation_type": "event_count",
    "parameters": {
      "time_window": "15m",
      "query": {
        "filter": {
          "type": "and",
          "conditions": [
            {
              "field": ".class_uid",
              "operator": "eq",
              "value": 1007
            },
            {
              "field": ".activity_id",
              "operator": "eq",
              "value": 1
            },
            {
              "field": ".process.name",
              "operator": "in",
              "value": ["certutil.exe", "regsvr32.exe", "mshta.exe", "rundll32.exe", "msiexec.exe", "regsvr32", "certutil", "mshta", "rundll32", "msiexec"]
            }
          ]
        }
      },
      "threshold": {
        "value": 3,
        "operator": "gte"
      },
      "group_by": [".device.hostname", ".actor.user.name"]
    }
  },
  "view": {
    "title": "Living-off-the-Land Binary (LOLBin) Execution",
    "severity": "high",
    "description": "Host {{device.hostname}} executed {{event_count}} LOLBin processes (certutil, regsvr32, mshta, rundll32, msiexec) - potential malicious activity",
    "category": "Execution",
    "tags": ["lolbins", "execution", "defense-evasion", "proxy-execution"],
    "mitre_attack": {
      "tactics": ["Execution", "Defense Evasion"],
      "techniques": [
        "T1218.010 - Signed Binary Proxy Execution: Regsvr32",
        "T1218.011 - Signed Binary Proxy Execution: Rundll32",
        "T1218.005 - Signed Binary Proxy Execution: Mshta",
        "T1218.007 - Signed Binary Proxy Execution: Msiexec",
        "T1105 - Ingress Tool Transfer"
      ]
    }
  },
  "controller": {
    "detection": {
      "suppression_window": "30m"
    },
    "response": {
      "actions": [],
      "severity_threshold": "high"
    }
  }
}
