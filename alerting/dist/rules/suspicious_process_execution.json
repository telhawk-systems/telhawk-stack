{
  "name": "suspicious_process_execution",
  "description": "Detects execution of commonly abused system utilities (PowerShell, cmd, bash) with suspicious command-line arguments",
  "model": {
    "correlation_type": "event_count",
    "parameters": {
      "time_window": "10m",
      "query": {
        "filter": {
          "type": "and",
          "conditions": [
            {
              "field": ".class_uid",
              "operator": "eq",
              "value": 1007
            },
            {
              "field": ".activity_id",
              "operator": "eq",
              "value": 1
            }
          ]
        }
      },
      "threshold": {
        "value": 5,
        "operator": "gte"
      },
      "group_by": [".actor.user.name", ".device.hostname"]
    }
  },
  "view": {
    "title": "Suspicious Process Execution Detected",
    "severity": "high",
    "description": "User {{actor.user.name}} on host {{device.hostname}} executed {{event_count}} suspicious processes in the last 10 minutes",
    "category": "Process Activity",
    "tags": ["process-execution", "living-off-the-land", "powershell", "command-line"],
    "mitre_attack": {
      "tactics": ["Execution"],
      "techniques": ["T1059.001 - Command and Scripting Interpreter: PowerShell", "T1059.003 - Command and Scripting Interpreter: Windows Command Shell", "T1059.004 - Command and Scripting Interpreter: Unix Shell"]
    }
  },
  "controller": {
    "detection": {
      "suppression_window": "20m"
    },
    "response": {
      "actions": [],
      "severity_threshold": "high"
    }
  }
}
