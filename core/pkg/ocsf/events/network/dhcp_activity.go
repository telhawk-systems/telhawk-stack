// Code generated by ocsf-generator. DO NOT EDIT.

package network

import (
	"time"
	"github.com/telhawk-systems/telhawk-stack/core/pkg/ocsf"
	"github.com/telhawk-systems/telhawk-stack/core/pkg/ocsf/objects"
)

// DHCP Activity - DHCP Activity events report MAC to IP assignment via DHCP from a client or server.
// OCSF Class UID: 4004
//
// This is a generated struct representing the OCSF event class.
type DhcpActivity struct {
	// Embed base OCSF event
	ocsf.Event

	// Class-specific attributes
	// The responder (server) of the DHCP connection.
	DstEndpoint *objects.NetworkEndpoint `json:"dst_endpoint,omitempty"`
	// Indicates whether this is a lease/session renewal event.
	IsRenewal bool `json:"is_renewal,omitempty"`
	LeaseDur int `json:"lease_dur,omitempty"`
	Relay *objects.NetworkInterface `json:"relay,omitempty"`
	// The initiator (client) of the DHCP connection.
	SrcEndpoint *objects.NetworkEndpoint `json:"src_endpoint,omitempty"`
	// The unique identifier of the transaction. This is typically a random number generated from the client to associate a dhcp request/response pair.
	TransactionUid string `json:"transaction_uid,omitempty"`
}

// Activity IDs for DHCP Activity
const (
	DhcpActivityActivityDiscover = 1 // DHCPDISCOVER
	DhcpActivityActivityOffer = 2 // DHCPOFFER
	DhcpActivityActivityRequest = 3 // DHCPREQUEST
	DhcpActivityActivityDecline = 4 // DHCPDECLINE
	DhcpActivityActivityAck = 5 // DHCPACK: The server accepts the request by sending the client a DHCP Acknowledgment message.
	DhcpActivityActivityNak = 6 // DHCPNAK
	DhcpActivityActivityRelease = 7 // DHCPRELEASE: A DHCP client sends a DHCPRELEASE packet to the server to release the IP address and cancel any remaining lease.
	DhcpActivityActivityInform = 8 // DHCPINFORM
	DhcpActivityActivityExpire = 9 // DHCPEXPIRE: A DHCP lease expired.
)

// NewDhcpActivity creates a new DHCP Activity event
func NewDhcpActivity(activityID int) *DhcpActivity {
	return &DhcpActivity{
		Event: ocsf.Event{
			CategoryUID: 4,
			ClassUID:    4004,
			ActivityID:  activityID,
			TypeUID:     ocsf.ComputeTypeUID(4, 4004, activityID),
			Time:        time.Now(),
			SeverityID:  ocsf.SeverityUnknown,
			Category:    "network",
			Class:       "dhcp_activity",
			Severity:    "Unknown",
			Metadata: ocsf.Metadata{
				Product: ocsf.Product{
					Name:   "TelHawk Stack",
					Vendor: "TelHawk Systems",
				},
				Version: "1.1.0",
			},
		},
	}
}

