// Code generated by TelHawk OCSF Generator. DO NOT EDIT.
//
// This generated code contains no original authorship and is released into the
// public domain. For convenience, TelHawk Systems provides it under the Apache
// License 2.0 as-is, without warranty of any kind.

package system

import (
	"time"
	"github.com/telhawk-systems/telhawk-stack/core/pkg/ocsf"
	"github.com/telhawk-systems/telhawk-stack/core/pkg/ocsf/objects"
)

// Memory Activity - Memory Activity events report when a process has memory allocated, read/modified, or other manipulation activities - such as a buffer overflow or turning off data execution protection (DEP).
// OCSF Class UID: 1004
//
// This is a generated struct representing the OCSF event class.
type MemoryActivity struct {
	// Embed base OCSF event
	ocsf.Event

	// Class-specific attributes
	// The permissions that were granted to access memory.
	ActualPermissions int `json:"actual_permissions,omitempty"`
	// The memory address that was access or requested.
	BaseAddress string `json:"base_address,omitempty"`
	// The process that had memory allocated, read/written, or had other manipulation activities performed on it.
	Process *objects.Process `json:"process"`
	// The permissions mask that was requested to access memory.
	RequestedPermissions int `json:"requested_permissions,omitempty"`
	// The memory size that was access or requested.
	Size int64 `json:"size,omitempty"`
}

// Activity IDs for Memory Activity
const (
	MemoryActivityActivityAllocatePage = 1 // 
	MemoryActivityActivityModifyPage = 2 // 
	MemoryActivityActivityDeletePage = 3 // 
	MemoryActivityActivityBufferOverflow = 4 // 
	MemoryActivityActivityDisableDEP = 5 // Data Execution Permission
	MemoryActivityActivityEnableDEP = 6 // Data Execution Permission
	MemoryActivityActivityRead = 7 // Read (Example: <code>ReadProcessMemory</code>)
	MemoryActivityActivityWrite = 8 // Write (Example: <code>WriteProcessMemory</code>)
	MemoryActivityActivityMapView = 9 // Map View (Example: <code>MapViewOfFile2</code>)
)

// NewMemoryActivity creates a new Memory Activity event
func NewMemoryActivity(activityID int) *MemoryActivity {
	return &MemoryActivity{
		Event: ocsf.Event{
			CategoryUID: 1,
			ClassUID:    1004,
			ActivityID:  activityID,
			TypeUID:     ocsf.ComputeTypeUID(1, 1004, activityID),
			Time:        time.Now(),
			SeverityID:  ocsf.SeverityUnknown,
			Category:    "system",
			Class:       "memory_activity",
			Severity:    "Unknown",
			Metadata: ocsf.Metadata{
				Product: ocsf.Product{
					Name:   "TelHawk Stack",
					Vendor: "TelHawk Systems",
				},
				Version: "1.1.0",
			},
		},
	}
}

