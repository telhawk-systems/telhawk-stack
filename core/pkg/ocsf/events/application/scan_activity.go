// Code generated by ocsf-generator. DO NOT EDIT.

package application

import (
	"time"
	"github.com/telhawk-systems/telhawk-stack/core/pkg/ocsf"
	"github.com/telhawk-systems/telhawk-stack/core/pkg/ocsf/objects"
)

// Scan Activity - Scan events report the start, completion, and results of a scan job. The scan event includes the number of items that were scanned and the number of detections that were resolved.
// OCSF Class UID: 6007
//
// This is a generated struct representing the OCSF event class.
type ScanActivity struct {
	// Embed base OCSF event
	ocsf.Event

	// Class-specific attributes
	// The command identifier that is associated with this scan event.  This ID uniquely identifies the proactive scan command, e.g., if remotely initiated.
	CommandUid string `json:"command_uid,omitempty"`
	// The duration of the scan
	Duration int64 `json:"duration,omitempty"`
	// The end time of the scan job.
	EndTime int64 `json:"end_time,omitempty"`
	NumDetections int `json:"num_detections,omitempty"`
	NumFiles int `json:"num_files,omitempty"`
	NumFolders int `json:"num_folders,omitempty"`
	NumNetworkItems int `json:"num_network_items,omitempty"`
	NumProcesses int `json:"num_processes,omitempty"`
	NumRegistryItems int `json:"num_registry_items,omitempty"`
	NumResolutions int `json:"num_resolutions,omitempty"`
	NumSkippedItems int `json:"num_skipped_items,omitempty"`
	NumTrustedItems int `json:"num_trusted_items,omitempty"`
	// The policy associated with this Scan event; required if the scan was initiated by a policy.
	Policy *objects.Policy `json:"policy,omitempty"`
	// The Scan object describes characteristics of the scan job.
	Scan *objects.Scan `json:"scan"`
	ScheduleUid string `json:"schedule_uid,omitempty"`
	// The start time of the scan job.
	StartTime int64 `json:"start_time,omitempty"`
	// The total number of items that were scanned; zero if no items were scanned.
	Total int `json:"total,omitempty"`
}

// Activity IDs for Scan Activity
const (
	ScanActivityActivityStarted = 1 // The scan was started.
	ScanActivityActivityDelayed = 10 // The user delayed the scan.
	ScanActivityActivityCompleted = 2 // The scan was completed.
	ScanActivityActivityCancelled = 3 // The scan was cancelled.
	ScanActivityActivityDurationViolation = 4 // The allocated scan time was insufficient to complete the requested scan.
	ScanActivityActivityPauseViolation = 5 // The scan was paused, either by the user or by program constraints (e.g. scans that are suspended during certain time intervals), and not resumed within the allotted time.
	ScanActivityActivityError = 6 // The scan could not be completed due to an internal error.
	ScanActivityActivityPaused = 7 // The scan was paused.
	ScanActivityActivityResumed = 8 // The scan was resumed from the pause point.
	ScanActivityActivityRestarted = 9 // The scan restarted from the beginning of the file enumeration.
)

// NewScanActivity creates a new Scan Activity event
func NewScanActivity(activityID int) *ScanActivity {
	return &ScanActivity{
		Event: ocsf.Event{
			CategoryUID: 6,
			ClassUID:    6007,
			ActivityID:  activityID,
			TypeUID:     ocsf.ComputeTypeUID(6, 6007, activityID),
			Time:        time.Now(),
			SeverityID:  ocsf.SeverityUnknown,
			Category:    "application",
			Class:       "scan_activity",
			Severity:    "Unknown",
			Metadata: ocsf.Metadata{
				Product: ocsf.Product{
					Name:   "TelHawk Stack",
					Vendor: "TelHawk Systems",
				},
				Version: "1.1.0",
			},
		},
	}
}

